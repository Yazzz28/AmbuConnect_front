<p-button (click)="showDialog()" class="button-edit" icon="pi pi-file-edit" severity="success" />

<p-dialog [(visible)]="visible" [modal]="true" maskStyleClass="backdrop-blur-sm" styleClass="!border-0 !bg-backGround modal-container">
  <ng-template #headless>
    <div class="flex flex-col form-container">
      <!-- Header with close button -->
      <div class="flex justify-between items-center mb-6 rounded-t-lg bg-header p-4 dialog-header">
        <h2 class="text-text font-semibold text-xl">
          {{ item[fieldToShow] }}
          @if (fieldToShowTwo) {
            <span> | {{ item[fieldToShowTwo] }}</span>
          }
        </h2>
        <button (click)="closeDialog()" class="text-text text-xl close-button" type="button">
          <span class="pi pi-times"></span>
        </button>
      </div>

      <!-- Dynamic form -->
      <form (ngSubmit)="save()" [formGroup]="form" class="dynamic-form">
        <div class="p-fluid form-fields-container">
          <!-- Loop over the fields in formUpdate -->
          @for (fieldConfig of formUpdate; track $index) {
            <div class="form-field-wrapper">
              <div class="p-field field-container">
                <label [class.required]="fieldConfig.required" [for]="fieldConfig.field" class="text-text field-label">
                  {{ fieldConfig.label }}
                </label>

                <!-- Handle different input types -->
                @if (
                  fieldConfig.type &&
                  [
                    'text',
                    'number',
                    'tel',
                    'address',
                    'date',
                    'email',
                    'password',
                    'url',
                    'search',
                    'range',
                    'color',
                    'time',
                    'datetime-local',
                    'month',
                    'week',
                  ].includes(fieldConfig.type)
                ) {
                  <input
                    [formControlName]="fieldConfig.field"
                    [type]="fieldConfig.type"
                    class="bg-backGroundPolygon border border-text rounded-md p-2 pl-10 w-25 focus:ring focus:ring-blue-300 outline-none text-text input-field" />
                }

                <!-- File input -->
                @if (fieldConfig.type === 'file') {
                  <input
                    [formControlName]="fieldConfig.field"
                    class="bg-backGroundPolygon border border-text rounded-md p-2 pl-10 w-25 focus:ring focus:ring-blue-300 outline-none text-text file-input"
                    type="file" />
                }

                <!-- Multiple files input -->
                @if (fieldConfig.type === 'file-multiple') {
                  <input
                    [formControlName]="fieldConfig.field"
                    class="bg-backGroundPolygon border border-text rounded-md p-2 pl-10 w-25 focus:ring focus:ring-blue-300 outline-none text-text multiple-file-input"
                    multiple
                    type="file" />
                }

                <!-- Boolean input (checkbox) -->
                @if (fieldConfig.type === 'checkbox') {
                  <input
                    [formControlName]="fieldConfig.field"
                    class="bg-backGroundPolygon border border-text rounded-md p-2 pl-10 w-25 focus:ring focus:ring-blue-300 outline-none text-text checkbox-input"
                    type="checkbox" />
                }

                <!-- Checkbox group -->
                @for (option of fieldConfig.options; track $index) {
                  <div class="checkbox-option">
                    <input
                      [formControlName]="fieldConfig.field"
                      [value]="option.value"
                      class="bg-backGroundPolygon border border-text rounded-md p-2 pl-10 w-25 focus:ring focus:ring-blue-300 outline-none text-text"
                      type="checkbox" />
                    {{ option.label }}
                  </div>
                }

                <!-- Textarea -->
                @if (fieldConfig.type === 'textarea') {
                  <textarea
                    [formControlName]="fieldConfig.field"
                    class="bg-backGroundPolygon border border-text rounded-md p-2 pl-10 w-25 focus:ring focus:ring-blue-300 outline-none text-text textarea-field"></textarea>
                }
              </div>
            </div>
          }
        </div>

        <!-- Buttons -->
        <div class="flex gap-12 justify-center mt-6 button-container">
          <button (click)="closeDialog()" class="button-cancel-delete px-8 py-3 text-lg rounded-md cancel-button" type="button">Annuler</button>
          <button class="button-save px-8 py-3 text-lg rounded-md save-button" type="submit">Sauvegarder</button>
        </div>
      </form>
    </div>
  </ng-template>
</p-dialog>
